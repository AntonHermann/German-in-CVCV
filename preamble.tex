\usepackage{tipa}
\usepackage{tikz-dependency}
\usepackage{tikz}
\usetikzlibrary{positioning}

% =============================================================
% word structure drawing commands
% =============================================================
\newcounter{vowel}
\newcounter{consonant}

\newenvironment{structure}{
  \setcounter{vowel}{0}
  \setcounter{consonant}{0}

  \newcommand\drawCV[1]{% param: count
    \foreach \x in {0,1,...,##1} {
        \node (C\x) at (1.5 * \x       , 0) {$C_{\x}$};
        \node (V\x) at (1.5 * \x + 0.75, 0) {$V_{\x}$};
    }
  }

  \newcommand\relation[3]{% params: Text, Coord1, Coord2
    \draw[->] (##2.north) ++(-0.1,0) -- ++(0,.2) -- node[above]{##1} (##3 |-, .5) -- (##3);
  }
  \newcommand\norelation[3]{% params: Text, Coord1, Coord2
    \draw[->] (##2.north) ++(-0.1,0) -- ++(0,.2) -- node[above]{##1} node{\tiny //} (##3 |-, .5) -- (##3);
  }

  \newcommand\vowel[2][]{% params: [style] vowel
    \edef\pos{V\thevowel}
    \node[##1] (p\pos) at (\pos |-, -1) {##2};
    \draw[##1] (\pos) -- (p\pos);
    \stepcounter{vowel}
  }
  \newcommand\consonant[2][]{% params: [style] consonant
    \edef\pos{C\theconsonant}
    \node[##1] (p\pos) at (\pos |-, -1) {##2};
    \draw[##1] (\pos) -- (p\pos);
    \stepcounter{consonant}
  }
  \newcommand\emptyNucleus{
    \stepcounter{vowel}
  }

  \newcommand\longvowel[1]{% param: vowel
    \edef\firstpos{V\thevowel}
    \stepcounter{vowel}
    \stepcounter{consonant}
    \edef\secondpos{V\thevowel}
    \vowel{##1}
    \draw[dashed] (p\secondpos) -- (\firstpos);
    \relation{Lic}{\secondpos}{\firstpos}
  }
  \newcommand\wordstart{
    \node (word-start) at (1.5*\theconsonant + 0.75/2, -1) {\#};
    \draw (C\theconsonant) -- (word-start) -- (V\thevowel);
    \stepcounter{consonant}
    \stepcounter{vowel}
  }
  \newcommand\fen{
    \edef\pos{V\thevowel}
    \draw[<-] (\pos.north) -- ++(0,0.2) -- node[above]{Gov} ++(1,0);
  }
  \begin{tikzpicture}[
    floating/.style={draw opacity=0}
  ]
}{
  \end{tikzpicture}
}